{"cells": [{"cell_type": "markdown", "metadata": {}, "source": ["# Mod\u00e8le d'Ising\n", "\n", "Un syst\u00e8me magn\u00e9tique peut-\u00eatre d\u00e9crit de fa\u00e7on simple avec l'Hamiltonien suivant (mod\u00e8le d'Heisenberg):\n", "\\begin{equation}\n", "    H = -\\frac{4}{h^2}\\sum_{i<j} J_{ij} \\vec{s}_i \\cdot \\vec{s}_j - \\gamma\\vec{B}\\cdot\\sum_i \\vec{s}_i\n", "\\end{equation}\n", "Dans cet exercice, nous allons nous int\u00e9resser \u00e0 un mod\u00e8le encore plus simple: celui d'un ensemble de spin 1/2 et ne consid\u00e9rer que l'int\u00e9raction entre les spins voisins les plus proches. En \u00e9crivant $\\vec{s}_i = \\frac{\\hbar}{2}S_i$ ($S_i=\\pm1$), on obtient le mod\u00e8le d'Ising d\u00e9crit par l'Hamiltonien:\n", "\\begin{equation}\n", "    H = -J\\sum_{\\langle i,j\\rangle} S_i S_j - \\mu B \\sum_i S_i\n", "\\end{equation}\n", "o\u00f9 la notation $\\langle i,j\\rangle$ denote la somme sur les paires des plus proches voisins. \n", "\n", "Nous allons dans cet exercice simuler ce syst\u00e8me \u00e0 l'aide d'un algorithme appel\u00e9 \"Metrolopolis\". Celui-ci est d\u00e9taill\u00e9 sur la page wikipedia d\u00e9di\u00e9 au model d'Ising. https://en.wikipedia.org/wiki/Ising_model . Nous prendrons un champ magn\u00e9tique nul.\n", "\n", "L'\u00e9tat du syst\u00e8me sera repr\u00e9sent\u00e9 par un tableau de taille $N\\times N$. Nous utiliserons des conditions p\u00e9riodiques (i.e. le spin \u00e0 la position $(N-1, j)$ est coupl\u00e9 au spin \u00e0 la position $(0, j)$, etc.\n", "\n", "1. \u00c9crire une fonction `energy(state)` qui retourne l'\u00e9nergie totale du syst\u00e8me magn\u00e9tique dans l'\u00e9tat 'state'.\n", "\n", "2. \u00c9crire une fonction `delta_energy(state, i, j)` qui retourne la difference d'\u00e9nergie induite par le flipping du spin de coordonnees `(i, j)`. Nous rappellons que seule l'int\u00e9raction entre plus proches voisins est consid\u00e9r\u00e9e.\n", "\n", "3. \u00c9crire une fonction `metropolis(state, beta, M)` qui retourne l'\u00e9tat du syst\u00e8me magn\u00e9tique apr\u00e8s avoir impl\u00e9ment\u00e9 M fois l'algorithme de Metrolopolis. Une r\u00e9alisation de l'algorithme correspond \u00e0 choisir un point de mani\u00e8re al\u00e9atoire, \u00e0 calculer la diff\u00e9rence d'\u00e9nergie induite par le flip de celui-ci. Si cette \u00e9nergie est n\u00e9gative, alors on consid\u00e8re que le spin flip. Si la diff\u00e9rence d'\u00e9nergie est positive, on autorise le spin flip selon la probabilit\u00e9: $e^{-\\beta \\Delta E}$. \n", "\n", "4. Afficher l'image pour $\\beta=1$, apr\u00e8s 1000, 1 000 000, 100 000 000 it\u00e9rations. Vous pouvez aussi faire une animation. On prendra comme \u00e9tat initial, 300x300 spins de valeur al\u00e9atoire $\\pm 1$. Il faudra utiliser numba.\n", "   \n", "5. Nous allons regarder l'\u00e9nergie moyenne du syst\u00e8me. Modifier votre fonction metropolis, de fa\u00e7on \u00e0 pouvoir enregistrer l'\u00e9nergie moyenne du syst\u00e8me pendant l'\u00e9volution. Pour \u00e9viter des probl\u00e8mes de m\u00e9moires, nous vous conseillons de l'enregistrer uniquement tous les $N^2$ r\u00e9alisations.\n", "\n", "   Tracer l'\u00e9nergie du syst\u00e8me au cours du temps. Observer le temps de convergence du syst\u00e8me (on prendra $\\beta=1$, $\\beta=0.2$ et $\\beta=0.1$). En plus de la convergence, qu'observez-vous pour $\\beta=0.2$ ? \n", "\n", "6. Tracer l'\u00e9nergie moyenne en fonction de $\\beta$. Vous pourrez aussi acc\u00e9l\u00e9rer votre calcul en l'\u00e9valuant sur plusieurs noyaux de votre ordinateur, \u00e0 l'aide du d\u00e9corateur: `@jit(parallel=True)` et de la boucle `for beta in numba.prange(xxx):`. \n", "\n", "7. De m\u00eame, tracer les fluctuations d'\u00e9nergie en fonction $\\beta$\n", "\n", "8. Comme vous l'avez vu en cours de Physique Statistique, il existe une solution analytique au mod\u00e8le d'Ising en deux dimensions:\n", "\n", "![alt text](solution_ising.JPG \"Title\")\n", "\n", "   Comment calculer l'\u00e9nergie moyenne du syst\u00e8me \u00e0 partir de la fonction de partition $Z$ ? Evaluez num\u00e9riquement cette expression et comparez \u00e0 votre simulation metrolopolis.\n", "\n", "   Si vous avez le temps, m\u00eame question pour les fluctuations d'\u00e9nergie\n", "\n", "9. La transition de phase a lieu pour $T$ qui v\u00e9rifie:\n", "\\begin{equation}\n", "    \\sinh\\left(\\frac{2J}{kT}\\right)= 1\n", "\\end{equation}\n", "R\u00e9solvez cette equation num\u00e9riquement (on pourra utiliser la fonction root de scipy) et comparez aux r\u00e9sultats de la question pr\u00e9c\u00e9dente.\n"]}, {"cell_type": "markdown", "metadata": {}, "source": ["On observe des fluctuations importantes pour la courbe $\\beta=0.2$"]}, {"cell_type": "markdown", "metadata": {}, "source": ["L'\u00e9nergie moyenne est donn\u00e9e par : \n", "\\begin{equation}\n", "\\left<E\\right> = -\\frac{\\partial\\ln Z}{\\partial \\beta}\n", "\\end{equation}\n", "\n", "Les fluctuations d'\u00e9nergie par la d\u00e9riv\u00e9e seconde."]}], "metadata": {"celltoolbar": "Tags", "kernelspec": {"display_name": "Python 3", "language": "python", "name": "python3"}, "language_info": {"codemirror_mode": {"name": "ipython", "version": 3}, "file_extension": ".py", "mimetype": "text/x-python", "name": "python", "nbconvert_exporter": "python", "pygments_lexer": "ipython3", "version": "3.8.8"}, "varInspector": {"cols": {"lenName": 16, "lenType": 16, "lenVar": 40}, "kernels_config": {"python": {"delete_cmd_postfix": "", "delete_cmd_prefix": "del ", "library": "var_list.py", "varRefreshCmd": "print(var_dic_list())"}, "r": {"delete_cmd_postfix": ") ", "delete_cmd_prefix": "rm(", "library": "var_list.r", "varRefreshCmd": "cat(var_dic_list()) "}}, "types_to_exclude": ["module", "function", "builtin_function_or_method", "instance", "_Feature"], "window_display": false}}, "nbformat": 4, "nbformat_minor": 4}